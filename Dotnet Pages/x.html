<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Book Filter</title>
  <style>
    .book-card { border: 1px solid #ccc; padding: 10px; margin: 10px; }
    .filters { margin-bottom: 20px; }
    .filters select { margin-right: 10px; }
  </style>
</head>
<body>
  <div class="filters">
    <select id="authorFilter"><option value="">All Authors</option></select>
    <select id="languageFilter"><option value="">All Languages</option></select>
    <select id="publisherFilter"><option value="">All Publishers</option></select>
    <select id="formatFilter"><option value="">All Formats</option></select>
  </div>

  <div id="bookContainer"></div>

  <script src="script.js"></script>
</body>

<script>
    let booksData = [];

async function fetchData() {
    const response = await fetch('http://localhost:5085/api/Book/GetAllBooks'); // replace with actual API
    const json = await response.json();
    booksData = json.data;
    populateFilters();
    renderBooks(booksData);
}

/*************  ✨ Windsurf Command ⭐  *************/
/*******  f9332f9c-f8ec-49d0-afd9-ea11b4430418  *******/
function populateFilters() {
    const authors = new Set();
    const languages = new Set();
    const publishers = new Set();
    const formats = new Set();

    booksData.forEach(book => {
        authors.add(book.authorName);
        languages.add(book.language);
        publishers.add(book.publisherName);
        formats.add(book.format);
    });

    populateSelect('authorFilter', authors);
    populateSelect('languageFilter', languages);
    populateSelect('publisherFilter', publishers);
    populateSelect('formatFilter', formats);
}

function populateSelect(id, items) {
    const select = document.getElementById(id);
    items.forEach(item => {
        const option = document.createElement('option');
        option.value = item;
        option.textContent = item;
        select.appendChild(option);
    });
}

function renderBooks(books) {
    const container = document.getElementById('bookContainer');
    container.innerHTML = '';

    books.forEach(book => {
        const card = document.createElement('div');
        card.className = 'book-card';
        card.innerHTML = `
            <img src="${book.coverImageUrl}" width="100"><br>
            <strong>${book.title}</strong><br>
            Author: ${book.authorName}<br>
            Language: ${book.language}<br>
            Publisher: ${book.publisherName}<br>
            Format: ${book.format}<br>
            Price: $${book.price}
        `;
        container.appendChild(card);
    });
}

function applyFilters() {
    const selectedAuthor = document.getElementById('authorFilter').value;
    const selectedLanguage = document.getElementById('languageFilter').value;
    const selectedPublisher = document.getElementById('publisherFilter').value;
    const selectedFormat = document.getElementById('formatFilter').value;

    const filtered = booksData.filter(book => {
        return (!selectedAuthor || book.authorName === selectedAuthor) &&
               (!selectedLanguage || book.language === selectedLanguage) &&
               (!selectedPublisher || book.publisherName === selectedPublisher) &&
               (!selectedFormat || book.format === selectedFormat);
    });

    renderBooks(filtered);
}

// Add change event listeners
document.addEventListener('DOMContentLoaded', () => {
    fetchData();
    ['authorFilter', 'languageFilter', 'publisherFilter', 'formatFilter'].forEach(id => {
        document.getElementById(id).addEventListener('change', applyFilters);
    });
});

</script>
</html>
